{% extends "base.html" %}

{% block content %}
  {% if user.is_authenticated %}
  <div class="dashboard-header">
    <h1>Customer Records Dashboard</h1>
    <p class="lead">Welcome back, {{ user.first_name|default:user.username }}!</p>
    <a href="{% url 'add' %}" class="btn btn-primary btn-lg">Add New Customer</a>
  </div>

  {% if records %}
  <div class="table-responsive">
    <table class="table table-striped table-hover">
      <thead class="table-dark">
        <tr>
          <th scope="col">ID</th>
          <th scope="col">Name</th>
          <th scope="col">Email</th>
          <th scope="col">Phone</th>
          <th scope="col">Address</th>
          <th scope="col">City</th>
          <th scope="col">State</th>
          <th scope="col">Zipcode</th>
          <th scope="col">Created At</th>
          <th scope="col">Actions</th>
        </tr>
      </thead>
      <tbody>
        {% for record in records %}
          <tr>
            <td><strong>{{ record.id }}</strong></td>
            <td><a href="{% url "record" record.id %}" class="text-decoration-none">{{ record.first_name }} {{ record.last_name }}</a></td>
            <td>{{ record.email }}</td>
            <td>{{ record.phone }}</td>
            <td>{{ record.address }}</td>
            <td>{{ record.city }}</td>
            <td>{{ record.state }}</td>
            <td>{{ record.zipcode }}</td>
            <td>{{ record.created_at|date:"M d, Y" }}</td>
            <td>
              <a href="{% url 'record' record.id %}" class="btn btn-sm btn-info btn-custom">View</a>
              <a href="{% url 'update' record.id %}" class="btn btn-sm btn-warning btn-custom">Edit</a>
              <a href="{% url 'delete' record.id %}" class="btn btn-sm btn-danger btn-custom" onclick="return confirm('Are you sure you want to delete this record?')">Delete</a>
            </td>
          </tr>
        {% endfor %}
      </tbody>
    </table>  
  </div>
  {% else %}
  <div class="text-center mt-5">
    <div class="record-card">
      <h3>No Customer Records Found</h3>
      <p class="text-muted">Get started by adding your first customer record.</p>
      <a href="{% url 'add' %}" class="btn btn-primary btn-lg">Add Your First Customer</a>
    </div>
  </div>
  {% endif %}

  {% else %}
  <div class="col-md-6 offset-md-3">
    <div class="login-form">
      <h1 class="text-center mb-4">Welcome to Django CRM</h1>
      <p class="text-center text-muted mb-4">Please log in to access your customer records</p>
      
      <form method="POST" action="{% url 'home' %}">
          {% csrf_token %}
      
        <div class="form-group">
          <label for="username">Username</label>
          <input type="text" class="form-control" id="username" name="username" placeholder="Enter your username" required>
        </div>
        
        <div class="form-group">
          <label for="password">Password</label>
          <input type="password" class="form-control" id="password" name="password" placeholder="Enter your password" required>
        </div>
        
        <button type="submit" class="btn btn-primary btn-block">Login</button>
        
        <hr>
        <div class="text-center">
          <p>Don't have an account? <a href="{% url 'register' %}">Register here</a></p>
        </div>
      </form>
    </div>
  </div>
  {% endif %}

{% endblock content %}
